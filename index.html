<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ittijah - Guide des M√©tiers et Orientation</title>
    <meta name="description" content="Guide d'orientation scolaire pour les √©l√®ves marocains.">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- MODAL STATS -->
    <div id="statsModal" class="modal">
        <div class="modal-content">
            <span class="close-btn"
                onclick="document.getElementById('statsModal').classList.remove('open')">&times;</span>
            <div id="statsBody">Chargement...</div>
        </div>
    </div>

    <!-- MODAL JOBS -->
    <div id="jobModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="window.app.closeModal()">&times;</span>
            <div id="modalBody">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>
    <!-- MOBILE MENU OVERLAY -->
    <div class="mobile-overlay" id="mobileOverlay" onclick="window.app.toggleMenu()"></div>

    <!-- HEADER -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">Ittijah<span>Maroc</span></div>

                <!-- Desktop Links -->
                <div class="nav-links" id="navLinks">
                    <button onclick="window.app.navigate('dashboard')">Accueil</button>
                    <button id="adminStatsBtn" class="admin-only" onclick="window.app.navigate('admin')"
                        style="display:none;">Statistiques</button>
                    <button onclick="window.app.navigate('jobs')">M√©tiers</button>
                    <button onclick="window.app.navigate('comparator')">Comparateur</button>
                    <!-- Added Button -->
                    <button onclick="window.app.navigate('reservation')"
                        style="color: var(--secondary); font-weight:700;">R√©server</button>

                    <button onclick="window.location.href='m√©tiers.html'">Par Branche</button>
                    <button onclick="window.location.href='√©coles/premier.html'">√âcoles</button>
                    <button onclick="window.app.logout()">Quitter</button>

                    <!-- BOUTON TH√àME DESKTOP MODERNE -->
                    <div class="theme-toggle-wrapper">
                        <button id="themeBtn" class="theme-toggle-btn" onclick="window.app.toggleTheme()"
                            aria-label="Changer le th√®me">
                            <!-- Moon Icon (Default) -->
                            <svg class="icon-moon" viewBox="0 0 24 24">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                            <!-- Sun Icon (Dark Mode) -->
                            <svg class="icon-sun" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="1" x2="12" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="23"></line>
                                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                <line x1="1" y1="12" x2="3" y2="12"></line>
                                <line x1="21" y1="12" x2="23" y2="12"></line>
                                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Mobile Burger -->
                <button class="menu-toggle" onclick="window.app.toggleMenu()">
                    <span></span><span></span><span></span>
                </button>
            </nav>
        </div>
    </header>

    <!-- MOBILE NAV DRAWER -->
    <div class="mobile-nav" id="mobileNav">
        <div style="margin-bottom: 20px; display:flex; justify-content:space-between; align-items:center;">
            <strong style="font-size:1.2rem; color:var(--primary);">Menu</strong>

            <!-- BOUTON TH√àME MOBILE MODERNE -->
            <div class="theme-toggle-wrapper">
                <button id="themeBtnMobile" class="theme-toggle-btn" onclick="window.app.toggleTheme()"
                    aria-label="Changer le th√®me" style="border:none; background:none;">
                    <svg class="icon-moon" viewBox="0 0 24 24">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg class="icon-sun" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <button onclick="window.app.navigate('dashboard'); window.app.toggleMenu()">üè† Accueil</button>
        <button id="adminStatsBtnMobile" class="admin-only"
            onclick="window.app.navigate('admin'); window.app.toggleMenu()" style="display:none;">üìä
            Statistiques</button>
        <button onclick="window.app.navigate('jobs'); window.app.toggleMenu()">üíº M√©tiers</button>
        <button onclick="window.app.navigate('comparator'); window.app.toggleMenu()">‚öñÔ∏è Comparateur</button>
        <button onclick="window.app.showStats(); window.app.toggleMenu()" style="color:var(--accent);">üìä
            Statistiques</button>
        <!-- Added Button -->
        <button onclick="window.app.navigate('reservation'); window.app.toggleMenu()">üìÖ R√©server / Contact</button>

        <button onclick="window.location.href='m√©tiers.html'; window.app.toggleMenu()">üìÇ Par Branche</button>
        <button onclick="window.location.href='√©coles/premier.html'; window.app.toggleMenu()">üéì √âcoles</button>
        <div style="flex:1"></div>
        <button onclick="window.app.logout(); window.app.toggleMenu()" style="color:var(--danger)">üö™ Quitter</button>
    </div>

    <main class="container">

        <!-- 0. AUTHENTICATION (New) -->
        <section id="auth">
            <div class="card" style="max-width: 400px; margin: 40px auto; text-align: center;">
                <h2 class="section-title">Connexion</h2>
                <div id="loginForm">
                    <input type="email" id="loginEmail" placeholder="Email"
                        style="width: 100%; margin-bottom: 10px; padding: 10px;">
                    <input type="password" id="loginPassword" placeholder="Mot de passe"
                        style="width: 100%; margin-bottom: 10px; padding: 10px;">
                    <button class="btn btn-primary btn-block" onclick="window.app.login()">Se connecter</button>
                    <p style="margin-top: 15px;">Pas encore de compte ? <a href="#"
                            onclick="window.app.toggleAuth('register')">S'inscrire</a></p>
                </div>

                <div id="registerForm" style="display:none;">
                    <input type="text" id="regName" placeholder="Nom complet"
                        style="width: 100%; margin-bottom: 10px; padding: 10px;">
                    <input type="email" id="regEmail" placeholder="Email"
                        style="width: 100%; margin-bottom: 10px; padding: 10px;">

                    <!-- NEW FIELDS -->
                    <select id="regLevel"
                        style="width: 100%; margin-bottom: 10px; padding: 10px; background:white; border:1px solid #ccc; border-radius:4px;">
                        <option value="" disabled selected>Niveau Scolaire</option>
                        <option value="3AC">3√®me Ann√©e Coll√®ge</option>
                        <option value="TC">Tronc Commun</option>
                        <option value="1BAC">1√®re Ann√©e Bac</option>
                        <option value="2BAC">2√®me Ann√©e Bac</option>
                    </select>

                    <select id="regStream"
                        style="width: 100%; margin-bottom: 10px; padding: 10px; background:white; border:1px solid #ccc; border-radius:4px;">
                        <option value="" disabled selected>Fili√®re / Option</option>
                        <optgroup label="Tronc Commun">
                            <option value="TC_Sc">Tronc Commun Scientifique</option>
                            <option value="TC_Lit">Tronc Commun Lettres</option>
                        </optgroup>
                        <optgroup label="Sciences Math√©matiques">
                            <option value="SMA">Sciences Math√©matiques A</option>
                            <option value="SMB">Sciences Math√©matiques B</option>
                        </optgroup>
                        <optgroup label="Sciences Exp√©rimentales">
                            <option value="PC">Sciences Physiques</option>
                            <option value="SVT">SVT</option>
                            <option value="Sc_Agro">Sciences Agronomiques</option>
                        </optgroup>
                        <optgroup label="Sciences & Technologies">
                            <option value="STE">Sc. et Technologies √âlectriques</option>
                            <option value="STM">Sc. et Technologies M√©caniques</option>
                        </optgroup>
                        <optgroup label="√âconomie & Gestion">
                            <option value="SEG">Sciences √âconomiques et Gestion</option>
                        </optgroup>
                        <optgroup label="Lettres & Sciences Humaines">
                            <option value="LSH">Lettres et Sciences Humaines</option>
                            <option value="SH">Sciences Humaines</option>
                            <option value="Langue_Arabe">Langue Arabe</option>
                            <option value="Sc_Chariaa">Sciences de la Chari√¢a</option>
                            <option value="Arts">Arts Appliqu√©s</option>
                        </optgroup>
                        <optgroup label="Professionnel">
                            <option value="BacPro">Baccalaur√©at Professionnel</option>
                        </optgroup>
                        <option value="Autre">Autre</option>
                    </select>

                    <input type="tel" id="regPhone" placeholder="T√©l√©phone (Optionnel)"
                        style="width: 100%; margin-bottom: 10px; padding: 10px;">
                    <input type="password" id="regPassword" placeholder="Mot de passe"
                        style="width: 100%; margin-bottom: 10px; padding: 10px;">
                    <button class="btn btn-primary btn-block" onclick="window.app.register()">Cr√©er un compte</button>
                    <p style="margin-top: 15px;">D√©j√† un compte ? <a href="#"
                            onclick="window.app.toggleAuth('login')">Se connecter</a></p>
                </div>
            </div>
        </section>

        <!-- ADMIN PANEL -->
        <section id="admin">
            <div class="card">
                <h2 class="section-title">üëë Panneau Administrateur</h2>
                <p style="margin-bottom: 20px;">Gestion des utilisateurs et statistiques</p>

                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="window.app.loadAdminUsers()">üîÑ Actualiser</button>
                </div>

                <div id="adminUsersTable" style="overflow-x: auto;">
                    <p>Chargement...</p>
                </div>
            </div>
        </section>

        <!-- 1. ONBOARDING -->
        <section id="onboarding">
            <div class="card"
                style="max-width: 500px; margin: 40px auto; text-align: center; border-top: 5px solid var(--secondary);">
                <div style="font-size: 3rem; margin-bottom: 10px;">üëã</div>
                <h2 class="section-title">Bienvenue sur Orient'Maroc</h2>
                <p style="color: var(--text-muted); margin-bottom: 30px;">Ton guide personnel pour construire ton avenir
                    au Maroc.</p>

                <form onsubmit="window.app.saveProfile(event)">
                    <div class="form-group">
                        <label style="text-align:left">Ton Pr√©nom</label>
                        <input type="text" id="name" required placeholder="Ex: Sara">
                    </div>

                    <div class="form-group">
                        <label style="text-align:left">Niveau Scolaire</label>
                        <select id="level" required onchange="window.app.toggleStream()">
                            <option value="">Choisir...</option>
                            <option value="3AC">3√®me Ann√©e Coll√®ge</option>
                            <option value="TC">Tronc Commun</option>
                            <option value="1BAC">1√®re Ann√©e Bac</option>
                            <option value="2BAC">2√®me Ann√©e Bac</option>
                        </select>
                    </div>

                    <div class="form-group" id="streamGroup" style="display:none;">
                        <label style="text-align:left">Fili√®re (Bac)</label>
                        <select id="stream">
                            <option value="">Aucune / Je ne sais pas</option>
                            <option value="SC_Maths">Sciences Maths</option>
                            <option value="SC_Exp">Sciences Exp√©rimentales</option>
                            <option value="STEG">Sciences Techniques (STEG)</option>
                            <option value="EG">√âconomie & Gestion</option>
                            <option value="SH">Sciences Humaines</option>
                            <option value="LP">Lettres & Philo</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block">Commencer mon aventure üöÄ</button>
                </form>
            </div>
        </section>

        <!-- 2. DASHBOARD -->
        <section id="dashboard">
            <div class="card"
                style="background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border:none;">
                <h1>Salut, <span id="uName">√âl√®ve</span> ! üëã</h1>
                <p style="opacity: 0.95; margin-top: 10px; font-size: 1.1rem;">Pr√™t √† d√©couvrir ton avenir professionnel
                    ?</p>
                <div style="margin-top: 25px;">
                    <button class="btn" style="background: white; color: var(--primary);"
                        onclick="window.location.href='test/test.html'; window.app.toggleMenu()">‚ú® Passer le Test
                        d'Orientation</button>
                </div>
            </div>

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
                <div class="stat-box">
                    <span class="stat-val" id="totalJobsCount">0</span>
                    <span class="stat-label">M√©tiers</span>
                </div>
                <div class="stat-box">
                    <span class="stat-val" id="totalCatsCount">0</span>
                    <span class="stat-label">Secteurs</span>
                </div>
            </div>

            <h3 class="section-title">üí° Suggestions du jour</h3>
            <div class="job-grid" id="featuredJobs"></div>
        </section>

        <!-- 3. QUIZ -->
        <section id="quiz">
            <div class="card">
                <div class="progress-container">
                    <div
                        style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:0.85rem; font-weight:600; color:var(--text-muted);">
                        <span>Progression</span>
                        <span id="quizProgressText">0%</span>
                    </div>
                    <div class="progress-bar-bg">
                        <div class="progress-bar-fill" id="quizProgress"></div>
                    </div>
                </div>
                <h2 id="qText" style="margin-bottom: 25px; font-size: 1.3rem;">Question...</h2>
                <div id="qOptions" class="options-grid"></div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-outline" onclick="window.app.navigate('dashboard')">Annuler le test</button>
            </div>
        </section>

        <!-- 4. RESULTS -->
        <section id="results">
            <div class="card" style="text-align: center; padding: 40px 20px;">
                <div style="font-size: 3rem; margin-bottom: 10px;">üéØ</div>
                <h2 class="section-title">Analyse Termin√©e</h2>
                <p>Ton profil d√©tect√© : <strong id="resProfile" style="color:var(--primary)"></strong></p>
                <div id="resTags"
                    style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; justify-content:center;"></div>
            </div>

            <div class="card">
                <h3 class="section-title">üíº M√©tiers recommand√©s</h3>
                <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 20px;">
                    Bas√©s sur ta fili√®re (<span id="resStream"></span>) et tes r√©ponses.
                </p>
                <div class="job-grid" id="resJobs"></div>
            </div>

            <div style="text-align: center;">
                <button class="btn btn-primary" onclick="window.app.saveAndExit()">Enregistrer et Retourner √†
                    l'Accueil</button>
            </div>
        </section>

        <!-- 5. JOBS DIRECTORY -->
        <section id="jobs">
            <div class="filter-bar">
                <div style="flex:2; width:100%;">
                    <input type="text" id="jobSearch" placeholder="üîç Rechercher un m√©tier, un mot-cl√©..."
                        oninput="window.app.filterJobs(document.getElementById('categoryFilter').value)">
                </div>
                <div style="flex:1; width:100%;">
                    <select id="categoryFilter" onchange="window.app.filterJobs(this.value)">
                        <option value="all">Toutes les cat√©gories</option>
                    </select>
                </div>
                <div
                    style="color: var(--text-muted); font-size: 0.9rem; font-weight:600; text-align:right; width:100%;">
                    <span id="currentCount">0</span> m√©tiers
                </div>
            </div>
            <div class="job-grid" id="jobsList"></div>
        </section>

        <!-- 6. COMPARATOR SECTION -->
        <section id="comparator">
            <div class="card">
                <h2 class="section-title">‚öñÔ∏è Comparateur de Fili√®res</h2>
                <p style="margin-bottom: 25px; color: var(--text-muted);">H√©site entre deux voies ? Compare-les pour
                    faire le bon choix.</p>

                <div class="compare-controls">
                    <div>
                        <label>Voie 1</label>
                        <select id="streamSelect1">
                            <option value="">-- S√©lectionner --</option>
                            <option value="sc_maths">Sciences Maths</option>
                            <option value="sc_exp">Sciences Exp√©rimentales</option>
                            <option value="eco">√âconomie & Gestion</option>
                            <option value="lettres">Lettres & Philosophie</option>
                            <option value="univ">Universit√© (Litt√©raire/Sc Humaines)</option>
                            <option value="ecoles">√âcoles Sup√©rieures</option>
                            <option value="ofppt">OFPPT (Formation Pro)</option>
                        </select>
                    </div>

                    <div>
                        <label>Voie 2</label>
                        <select id="streamSelect2">
                            <option value="">-- S√©lectionner --</option>
                            <option value="sc_maths">Sciences Maths</option>
                            <option value="sc_exp">Sciences Exp√©rimentales</option>
                            <option value="eco">√âconomie & Gestion</option>
                            <option value="lettres">Lettres & Philosophie</option>
                            <option value="univ">Universit√© (Litt√©raire/Sc Humaines)</option>
                            <option value="ecoles">√âcoles Sup√©rieures</option>
                            <option value="ofppt">OFPPT (Formation Pro)</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" onclick="window.app.comparator.runComparison()"
                        style="height: 50px; margin-top:0;">Comparer</button>
                </div>
            </div>

            <div id="compareResults" class="job-grid"></div>

            <div
                style="text-align: center; margin-top: 40px; padding: 20px; background:var(--bg-input); border-radius: var(--radius-md);">
                <p style="margin-bottom: 15px; font-weight:600;">Ind√©cis ? Passez notre test personnalis√©.</p>
                <button class="btn btn-outline" onclick="window.app.startQuiz()">Faire le test d'orientation</button>
            </div>
        </section>

        <!-- 7. RESERVATION / CONTACT FORM (NEW) -->
        <section id="reservation">
            <div class="card" style="max-width: 600px; margin: 0 auto; border-top: 5px solid var(--accent);">
                <div style="text-align:center; margin-bottom: 25px;">
                    <div style="font-size: 3rem; margin-bottom: 10px;">üìÖ</div>
                    <h2 class="section-title">R√©server / Contact</h2>
                    <p style="color: var(--text-muted);">Besoin d'un rendez-vous d'orientation ou d'une question ?
                        Remplissez ce formulaire.</p>
                </div>

                <!-- Formspree Form Integrated Here -->
                <form id="fs-form" action="https://formspree.io/f/xojloypv" method="POST">

                    <div class="form-group">
                        <label for="name">Votre Nom Complet</label>
                        <input type="text" id="name" name="name" required placeholder="Ex: Souhail Belgounche">
                    </div>

                    <div class="form-group">
                        <label for="email">Votre Email</label>
                        <input type="email" id="email" name="email" required placeholder="Ex: souhail@example.com">
                    </div>

                    <div class="form-group">
                        <label for="phone">T√©l√©phone (Optionnel)</label>
                        <input type="tel" id="phone" name="phone" placeholder="Ex: 0661123456">
                    </div>

                    <div class="form-group">
                        <label for="subject">Sujet</label>
                        <select id="subject" name="subject" required>
                            <option value="Rendez-vous Orientation">üìÖ Rendez-vous Orientation</option>
                            <option value="Question sur une fili√®re">‚ùì Question sur une fili√®re</option>
                            <option value="Partenariat">ü§ù Partenariat</option>
                            <option value="Autre">üí¨ Autre</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="message">Votre Message</label>
                        <textarea id="message" name="message" rows="5" required
                            placeholder="Dites-nous en plus sur votre besoin..."></textarea>
                    </div>

                    <button type="submit" id="submit-btn" class="btn btn-primary btn-block">Envoyer ma demande</button>

                    <p style="text-align:center; font-size:0.8rem; margin-top:15px; color:var(--text-muted);">
                        Vos donn√©es sont transmises de mani√®re s√©curis√©e.
                    </p>
                </form>
            </div>
        </section>

    </main>

    <script src="script.js"></script>

    <!-- CHATBOT INTEGRATION -->
    <script async type='module'
        src='https://interfaces.zapier.com/assets/web-components/zapier-interfaces/zapier-interfaces.esm.js'></script>
    <zapier-interfaces-chatbot-embed is-popup='true'
        chatbot-id='cml6yl3ga000ciem38z0cx24k'></zapier-interfaces-chatbot-embed>

</body>

</html>